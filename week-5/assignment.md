안녕하세요!

5주차에는 **Foundry 사용법**을 복습하는 시간입니다.

지난주 주점 및 엠티, 학교 행사 등으로 인해 다들 바쁘셨고 wsl 설치에서부터 고전하신 분도 계시기에 과제를 더 많이 나간다기보다는 지난주 과제를 복습하는 것이 맞겠다고 판단했습니다.


## **첫 번째 과제:** 지난 주 과제 복습해오기

ERC20 컨트랙트를 foundry를 이용해서 빌드, 배포하고 테스트 및 상호작용하는 것을 복습해오시기 바랍니다.
(week-4 스터디 깃허브 디렉토리에 코드 전부 있습니다.)


프로젝트 세팅 후에 우선 지난 번 보여드린 것처럼 빌드, 테스트, 배포 스크립트를 실행해보시기 바랍니다. 

1) forge build
2) forge test
3) Anvil 실행 후에(새 터미널 열고 'anvil') 
---
forge script script/ComitToken.s.sol --rpc-url http://127.0.0.1:8545 
--broadcast --ffi --unlocked 첫번째지갑주소 --sender 첫번째지갑주소
---
위 세 과정에서 테스트 함수도 바꿔보고 anvil 및 프로젝트 디렉토리 구조도 살펴보며 깨작거리는 시간을 조금 보내시는 것을 추천드립니다. 강추

​그리고 이제 배포된 컨트랙트랑 상호작용할 차례입니다.

지난번 스터디 마지막에 상호작용 명령어가 되지 않았던 이유를 살펴보니 긴 명령어 사이에 줄바꿈 문자가 들어갔기 때문이었습니다. 명령어가 길다보니 터미널에 복사 전 가독성 등의 이유로 그 중간에 줄바꿈을 해놓았었는데 그렇게 됐네요ㅠ 다들 주의하시기 바랍니다.

https://docs.google.com/document/d/1jcBJOpds4XC4o_5K-34yAhWGLz6OQIKrvaBVIYhWlz8/edit?usp=sharing

로컬 Anvil 네트워크에 배포된 ComitToken 컨트랙트와 상호작용하는 예시 명령어들과 그 설명을 담은 문서를 간단히 만들었습니다. 위의 문서 보시면서 차례대로 여러 명령어들에 익숙해지기 바랍니다. 

다음 스터디 시간에 문서 속 시나리오대로 상호작용 한 후 지갑2의 잔액을 스크린샷 한 것을 확인하겠습니다.


## **두 번째 과제:** Foundry 실습: 성균관대학교 축제 주점 매출 기록
두 번째 과제는 '대학교 축제 주점 매출 기록' 컨트랙트를 개발입니다. 코밋 축제 주점의 당일 매출을 기록하는 간단한 컨트랙트입니다.

### [과제 내용]

1. 주점의 일일 매출을 기록하는 PubSalesRecord.sol 을 작성
컨트랙트 세부 정보를 아래와 동일하게 설정하시면 됩니다.


함수 (Functions)

constructor(): 상품별 초기 가격을 itemPrices 매핑에 설정
recordSale(itemName): 상품 이름을 인자로 받아 해당 상품의 가격만큼 총 매출 증가시키고, 팔린 상품 총 개수를 증가. 매출 기록 이벤트 발생, 총 매출이 50을 넘겼다면 콘솔 출력 및 해당 이벤트 발생
getTotalRevenue(): 현재까지의 총 매출을 반환
getTotalItemsSold(): 현재까지 팔린 상품의 총 개수를 반환


가격표 (단위: 천원)

* Admission(입장) - 20
* Odeng Soup(오뎅탕) - 10
* Steamed Eggs(계란찜) - 3
* Sausage and Vegetable Stir-fry(쏘세지 야채볶음)
​

변수 및 이벤트 목록

총 매출을 저장하는 변수 totalRevenue
팔린 상품의 총 개수를 저장하는 변수 totalItemsSold
상품별 가격을 저장하는 매핑 mapping(string => uint) itemPrices;
---
매출 50(천원) 달성 시 발생하는 이벤트 RevenueMilestone50
매출 생길 때마다 기록하는 이벤트 SaleRecorded


2. 배포 및 테스트 코드 작성

테스트 함수는 간단히 두 가지입니다.

testRecordSale()
테스트 1: 기본 판매 기록 및 상태 업데이트 테스트

testRevenueMilestone50Trigger()
테스트 2: 매출 50 달성 이벤트 테스트

세부 로직은 자유입니다. test 스크립트 작성 후에 실제로 테스트를 통과하시는지 확인해보시기 바랍니다.
테스트까지 완료하셨다면 배포 후에 해당 컨트랙트의 함수를 여러번 호출하여 총 매출을 50을 넘게 증가시킨 것을 스크린샷하여 스터디 시간에 공유해주시면 되겠습니다.

고생하셨습니다.

​